/*!
* Parsley.js
* Version 2.2.0-rc4 - built Thu, Oct 29th 2015, 4:25 pm
* http://parsleyjs.org
* Guillaume Potier - <guillaume@wisembly.com>
* Marc-Andre Lafortune - <petroselinum@marc-andre.ca>
* MIT Licensed
*/

(function(e,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t(require("jquery")):typeof define=="function"&&define.amd?define(["jquery"],t):e.parsley=t(e.jQuery)})(this,function(e){"use strict";function A(e,t){return e.parsleyAdaptedCallback||(e.parsleyAdaptedCallback=function(){var n=Array.prototype.slice.call(arguments,0);n.unshift(this),e.apply(t||k,n)}),e.parsleyAdaptedCallback}function M(e){return e.lastIndexOf(O,0)===0?e.substr(O.length):e}var t=1,n={},r={attr:function(t,n,r){var i,s,o,u=new RegExp("^"+n,"i");if("undefined"==typeof r)r={};else for(i in r)r.hasOwnProperty(i)&&delete r[i];if("undefined"==typeof t||"undefined"==typeof t[0])return r;o=t[0].attributes;for(i=o.length;i--;)s=o[i],s&&s.specified&&u.test(s.name)&&(r[this.camelize(s.name.slice(n.length))]=this.deserializeValue(s.value));return r},checkAttr:function(t,n,r){return t.is("["+n+r+"]")},setAttr:function(t,n,r,i){t[0].setAttribute(this.dasherize(n+r),String(i))},generateID:function(){return""+t++},deserializeValue:function(n){var r;try{return n?n=="true"||(n=="false"?!1:n=="null"?null:isNaN(r=Number(n))?/^[\[\{]/.test(n)?e.parseJSON(n):n:r):n}catch(i){return n}},camelize:function(t){return t.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},dasherize:function(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()},warn:function(){window.console&&"function"==typeof window.console.warn&&window.console.warn.apply(window.console,arguments)},warnOnce:function(t){n[t]||(n[t]=!0,this.warn.apply(this,arguments))},_resetWarnings:function(){n={}},trimString:function(t){return t.replace(/^\s+|\s+$/g,"")},objectCreate:Object.create||function(){var e=function(){};return function(t){if(arguments.length>1)throw Error("Second argument not supported");if(typeof t!="object")throw TypeError("Argument must be an object");e.prototype=t;var n=new e;return e.prototype=null,n}}()},i=r,s={namespace:"data-parsley-",inputs:"input, textarea, select",excluded:"input[type=button], input[type=submit], input[type=reset], input[type=hidden]",priorityEnabled:!0,multiple:null,group:null,uiEnabled:!0,validationThreshold:3,focus:"first",trigger:!1,errorClass:"parsley-error",successClass:"parsley-success",classHandler:function(t){},errorsContainer:function(t){},errorsWrapper:'<ul class="parsley-errors-list"></ul>',errorTemplate:"<li></li>"},o=function(){};o.prototype={asyncSupport:!0,actualizeOptions:function(){return i.attr(this.$element,this.options.namespace,this.domOptions),this.parent&&this.parent.actualizeOptions&&this.parent.actualizeOptions(),this},_resetOptions:function(t){this.domOptions=i.objectCreate(this.parent.options),this.options=i.objectCreate(this.domOptions);for(var n in t)t.hasOwnProperty(n)&&(this.options[n]=t[n]);this.actualizeOptions()},_listeners:null,on:function(t,n){this._listeners=this._listeners||{};var r=this._listeners[t]=this._listeners[t]||[];return r.push(n),this},subscribe:function(n,r){e.listenTo(this,n.toLowerCase(),r)},off:function(t,n){var r=this._listeners&&this._listeners[t];if(r)if(!n)delete this._listeners[t];else for(var i=r.length;i--;)r[i]===n&&r.splice(i,1);return this},unsubscribe:function(n,r){e.unsubscribeTo(this,n.toLowerCase())},trigger:function(t,n,r){n=n||this;var i=this._listeners&&this._listeners[t],s,o;if(i)for(var u=i.length;u--;){s=i[u].call(n,n,r);if(s===!1)return s}return this.parent?this.parent.trigger(t,n,r):!0},reset:function(){if("ParsleyForm"!==this.__class__)return this._trigger("reset");for(var t=0;t<this.fields.length;t++)this.fields[t]._trigger("reset");this._trigger("reset")},destroy:function(){if("ParsleyForm"!==this.__class__){this.$element.removeData("Parsley"),this.$element.removeData("ParsleyFieldMultiple"),this._trigger("destroy");return}for(var t=0;t<this.fields.length;t++)this.fields[t].destroy();this.$element.removeData("Parsley"),this._trigger("destroy")},asyncIsValid:function(){return i.warnOnce("asyncIsValid is deprecated; please use whenIsValid instead"),this.whenValid.apply(this,arguments)},_findRelatedMultiple:function(){return this.parent.$element.find("["+this.options.namespace+'multiple="'+this.options.multiple+'"]')}};var u={string:function(t){return t},integer:function(t){if(isNaN(t))throw'Requirement is not an integer: "'+t+'"';return parseInt(t,10)},number:function(t){if(isNaN(t))throw'Requirement is not a number: "'+t+'"';return parseFloat(t)},reference:function(n){var r=e(n);if(r.length===0)throw'No such reference: "'+n+'"';return r},"boolean":function(t){return t!=="false"},object:function(t){return i.deserializeValue(t)},regexp:function(t){var n="";return/^\/.*\/(?:[gimy]*)$/.test(t)?(n=t.replace(/.*\/([gimy]*)$/,"$1"),t=t.replace(new RegExp("^/(.*?)/"+n+"$"),"$1")):t="^"+t+"$",new RegExp(t,n)}},a=function(t,n){var r=t.match(/^\s*\[(.*)\]\s*$/);if(!r)throw'Requirement is not an array: "'+t+'"';var s=r[1].split(",").map(i.trimString);if(s.length!==n)throw"Requirement has "+s.length+" values when "+n+" are needed";return s},f=function(t,n){var r=u[t||"string"];if(!r)throw'Unknown requirement specification: "'+t+'"';return r(n)},l=function(t,n,r){var i=null,s={};for(var o in t)if(o){var u=r(o);"string"==typeof u&&(u=f(t[o],u)),s[o]=u}else i=f(t[o],n);return[i,s]},c=function(n){e.extend(!0,this,n)};c.prototype={validate:function(n,r){if(this.fn)return arguments.length>3&&(r=[].slice.call(arguments,1,-1)),this.fn.call(this,n,r);if(e.isArray(n)){if(!this.validateMultiple)throw"Validator `"+this.name+"` does not handle multiple values";return this.validateMultiple.apply(this,arguments)}if(this.validateNumber)return isNaN(n)?!1:(arguments[0]=parseFloat(arguments[0]),this.validateNumber.apply(this,arguments));if(this.validateString)return this.validateString.apply(this,arguments);throw"Validator `"+this.name+"` only handles multiple values"},parseRequirements:function(n,r){if("string"!=typeof n)return e.isArray(n)?n:[n];var i=this.requirementType;if(e.isArray(i)){var s=a(n,i.length);for(var o=0;o<s.length;o++)s[o]=f(i[o],s[o]);return s}return e.isPlainObject(i)?l(i,n,r):[f(i,n)]},requirementType:"string",priority:2};var h=function(t,n){this.__class__="ParsleyValidatorRegistry",this.locale="en",this.init(t||{},n||{})},p={email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/,integer:/^-?\d+$/,digits:/^\d+$/,alphanum:/^\w+$/i,url:new RegExp("^(?:(?:https?|ftp)://)?(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:/\\S*)?$","i")};p.range=p.number,h.prototype={init:function(n,r){this.catalog=r,this.validators=e.extend({},this.validators);for(var i in n)this.addValidator(i,n[i].fn,n[i].priority);window.Parsley.trigger("parsley:validator:init")},setLocale:function(t){if("undefined"==typeof this.catalog[t])throw new Error(t+" is not available in the catalog");return this.locale=t,this},addCatalog:function(t,n,r){return"object"==typeof n&&(this.catalog[t]=n),!0===r?this.setLocale(t):this},addMessage:function(t,n,r){return"undefined"==typeof this.catalog[t]&&(this.catalog[t]={}),this.catalog[t][n]=r,this},addMessages:function(t,n){for(var r in n)this.addMessage(t,r,n[r]);return this},addValidator:function(t,n,r){if(this.validators[t])i.warn('Validator "'+t+'" is already defined.');else if(s.hasOwnProperty(t)){i.warn('"'+t+'" is a restricted keyword and is not a valid validator name.');return}return this._setValidator.apply(this,arguments)},updateValidator:function(t,n,r){return this.validators[t]?this._setValidator(this,arguments):(i.warn('Validator "'+t+'" is not already defined.'),this.addValidator.apply(this,arguments))},removeValidator:function(t){return this.validators[t]||i.warn('Validator "'+t+'" is not defined.'),delete this.validators[t],this},_setValidator:function(t,n,r){"object"!=typeof n&&(n={fn:n,priority:r}),n.validate||(n=new c(n)),this.validators[t]=n;for(var i in n.messages||{})this.addMessage(i,t,n.messages[i]);return this},getErrorMessage:function(t){var n;if("type"===t.name){var r=this.catalog[this.locale][t.name]||{};n=r[t.requirements]}else n=this.formatMessage(this.catalog[this.locale][t.name],t.requirements);return n||this.catalog[this.locale].defaultMessage||this.catalog.en.defaultMessage},formatMessage:function(t,n){if("object"==typeof n){for(var r in n)t=this.formatMessage(t,n[r]);return t}return"string"==typeof t?t.replace(new RegExp("%s","i"),n):""},validators:{notblank:{validateString:function(t){return/\S/.test(t)},priority:2},required:{validateMultiple:function(t){return t.length>0},validateString:function(t){return/\S/.test(t)},priority:512},type:{validateString:function(t,n){var r=p[n];if(!r)throw new Error("validator type `"+n+"` is not supported");return r.test(t)},priority:256},pattern:{validateString:function(t,n){return n.test(t)},requirementType:"regexp",priority:64},minlength:{validateString:function(t,n){return t.length>=n},requirementType:"integer",priority:30},maxlength:{validateString:function(t,n){return t.length<=n},requirementType:"integer",priority:30},length:{validateString:function(t,n,r){return t.length>=n&&t.length<=r},requirementType:["integer","integer"],priority:30},mincheck:{validateMultiple:function(t,n){return t.length>=n},requirementType:"integer",priority:30},maxcheck:{validateMultiple:function(t,n){return t.length<=n},requirementType:"integer",priority:30},check:{validateMultiple:function(t,n,r){return t.length>=n&&t.length<=r},requirementType:["integer","integer"],priority:30},min:{validateNumber:function(t,n){return t>=n},requirementType:"number",priority:30},max:{validateNumber:function(t,n){return t<=n},requirementType:"number",priority:30},range:{validateNumber:function(t,n,r){return t>=n&&t<=r},requirementType:["number","number"],priority:30},equalto:{validateString:function(n,r){var i=e(r);return i.length?n===i.val():n===r},priority:256}}};var d=function(t){this.__class__="ParsleyUI"};d.prototype={listen:function(){var t=this;return window.Parsley.on("form:init",function(){t.setupForm(this)}).on("field:init",function(){t.setupField(this)}).on("field:validated",function(){t.reflow(this)}).on("form:validated",function(){t.focus(this)}).on("field:reset",function(){t.reset(this)}).on("form:destroy",function(){t.destroy(this)}).on("field:destroy",function(){t.destroy(this)}),this},reflow:function(t){if("undefined"==typeof t._ui||!1===t._ui.active)return;var n=this._diff(t.validationResult,t._ui.lastValidationResult);t._ui.lastValidationResult=t.validationResult,t._ui.validatedOnce=!0,this.manageStatusClass(t),this.manageErrorsMessages(t,n),this.actualizeTriggers(t),(n.kept.length||n.added.length)&&!0!==t._ui.failedOnce&&this.manageFailingFieldTrigger(t)},getErrorsMessages:function(t){if(!0===t.validationResult)return[];var n=[];for(var r=0;r<t.validationResult.length;r++)n.push(t.validationResult[r].errorMessage||this._getErrorMessage(t,t.validationResult[r].assert));return n},manageStatusClass:function(t){t.hasConstraints()&&t.needsValidation()&&!0===t.validationResult?this._successClass(t):t.validationResult.length>0?this._errorClass(t):this._resetClass(t)},manageErrorsMessages:function(n,r){if("undefined"!=typeof n.options.errorsMessagesDisabled)return;if("undefined"!=typeof n.options.errorMessage)return r.added.length||r.kept.length?(this._insertErrorWrapper(n),0===n._ui.$errorsWrapper.find(".parsley-custom-error-message").length&&n._ui.$errorsWrapper.append(e(n.options.errorTemplate).addClass("parsley-custom-error-message")),n._ui.$errorsWrapper.addClass("filled").find(".parsley-custom-error-message").html(n.options.errorMessage)):n._ui.$errorsWrapper.removeClass("filled").find(".parsley-custom-error-message").remove();for(var i=0;i<r.removed.length;i++)this.removeError(n,r.removed[i].assert.name,!0);for(i=0;i<r.added.length;i++)this.addError(n,r.added[i].assert.name,r.added[i].errorMessage,r.added[i].assert,!0);for(i=0;i<r.kept.length;i++)this.updateError(n,r.kept[i].assert.name,r.kept[i].errorMessage,r.kept[i].assert,!0)},addError:function(n,r,i,s,o){this._insertErrorWrapper(n),n._ui.$errorsWrapper.addClass("filled").append(e(n.options.errorTemplate).addClass("parsley-"+r).html(i||this._getErrorMessage(n,s))),!0!==o&&this._errorClass(n)},updateError:function(t,n,r,i,s){t._ui.$errorsWrapper.addClass("filled").find(".parsley-"+n).html(r||this._getErrorMessage(t,i)),!0!==s&&this._errorClass(t)},removeError:function(t,n,r){t._ui.$errorsWrapper.removeClass("filled").find(".parsley-"+n).remove(),!0!==r&&this.manageStatusClass(t)},focus:function(t){t._focusedField=null;if(!0===t.validationResult||"none"===t.options.focus)return null;for(var n=0;n<t.fields.length;n++){var r=t.fields[n];if(!0!==r.validationResult&&r.validationResult.length>0&&"undefined"==typeof r.options.noFocus){t._focusedField=r.$element;if("first"===t.options.focus)break}}return null===t._focusedField?null:t._focusedField.focus()},_getErrorMessage:function(t,n){var r=n.name+"Message";return"undefined"!=typeof t.options[r]?window.Parsley.formatMessage(t.options[r],n.requirements):window.Parsley.getErrorMessage(n)},_diff:function(t,n,r){var i=[],s=[];for(var o=0;o<t.length;o++){var u=!1;for(var a=0;a<n.length;a++)if(t[o].assert.name===n[a].assert.name){u=!0;break}u?s.push(t[o]):i.push(t[o])}return{kept:s,added:i,removed:r?[]:this._diff(n,t,!0).added}},setupForm:function(n){n.$element.on("submit.Parsley",!1,e.proxy(n.onSubmitValidate,n)),n.$element.on("click.Parsley",'input[type="submit"], button[type="submit"]',e.proxy(n.onSubmitButton,n));if(!1===n.options.uiEnabled)return;n.$element.attr("novalidate","")},setupField:function(n){var r={active:!1};if(!1===n.options.uiEnabled)return;r.active=!0,n.$element.attr(n.options.namespace+"id",n.__id__),r.$errorClassHandler=this._manageClassHandler(n),r.errorsWrapperId="parsley-id-"+(n.options.multiple?"multiple-"+n.options.multiple:n.__id__),r.$errorsWrapper=e(n.options.errorsWrapper).attr("id",r.errorsWrapperId),r.lastValidationResult=[],r.validatedOnce=!1,r.validationInformationVisible=!1,n._ui=r,this.actualizeTriggers(n)},_manageClassHandler:function(n){if("string"==typeof n.options.classHandler&&e(n.options.classHandler).length)return e(n.options.classHandler);var r=n.options.classHandler(n);return"undefined"!=typeof r&&r.length?r:!n.options.multiple||n.$element.is("select")?n.$element:n.$element.parent()},_insertErrorWrapper:function(n){var r;if(0!==n._ui.$errorsWrapper.parent().length)return n._ui.$errorsWrapper.parent();if("string"==typeof n.options.errorsContainer){if(e(n.options.errorsContainer).length)return e(n.options.errorsContainer).append(n._ui.$errorsWrapper);i.warn("The errors container `"+n.options.errorsContainer+"` does not exist in DOM")}else"function"==typeof n.options.errorsContainer&&(r=n.options.errorsContainer(n));if("undefined"!=typeof r&&r.length)return r.append(n._ui.$errorsWrapper);var s=n.$element;return n.options.multiple&&(s=s.parent()),s.after(n._ui.$errorsWrapper)},actualizeTriggers:function(n){var r=n.$element;n.options.multiple&&(r=e("["+n.options.namespace+'multiple="'+n.options.multiple+'"]')),r.off(".Parsley");if(!1===n.options.trigger)return;var i=n.options.trigger.replace(/^\s+/g,"").replace(/\s+$/g,"");if(""===i)return;r.on(i.split(" ").join(".Parsley ")+".Parsley",e.proxy("function"==typeof n.eventValidate?n.eventValidate:this.eventValidate,n))},eventValidate:function(t){if((new RegExp("key")).test(t.type)&&!this._ui.validationInformationVisible&&this.getValue().length<=this.options.validationThreshold)return;this._ui.validatedOnce=!0,this.validate()},manageFailingFieldTrigger:function(n){n._ui.failedOnce=!0,n.options.multiple&&e("["+n.options.namespace+'multiple="'+n.options.multiple+'"]').each(function(){if(!(new RegExp("change","i")).test(e(this).parsley().options.trigger||""))return e(this).on("change.ParsleyFailedOnce",!1,e.proxy(n.validate,n))});if(n.$element.is("select")&&!(new RegExp("change","i")).test(n.options.trigger||""))return n.$element.on("change.ParsleyFailedOnce",!1,e.proxy(n.validate,n));if(!(new RegExp("keyup","i")).test(n.options.trigger||""))return n.$element.on("keyup.ParsleyFailedOnce",!1,e.proxy(n.validate,n))},reset:function(t){this.actualizeTriggers(t),t.$element.off(".ParsleyFailedOnce");if("undefined"==typeof t._ui)return;if("ParsleyForm"===t.__class__)return;t._ui.$errorsWrapper.removeClass("filled").children().remove(),this._resetClass(t),t._ui.validatedOnce=!1,t._ui.lastValidationResult=[],t._ui.validationInformationVisible=!1,t._ui.failedOnce=!1},destroy:function(t){this.reset(t);if("ParsleyForm"===t.__class__)return;"undefined"!=typeof t._ui&&t._ui.$errorsWrapper.remove(),delete t._ui},_successClass:function(t){t._ui.validationInformationVisible=!0,t._ui.$errorClassHandler.removeClass(t.options.errorClass).addClass(t.options.successClass)},_errorClass:function(t){t._ui.validationInformationVisible=!0,t._ui.$errorClassHandler.removeClass(t.options.successClass).addClass(t.options.errorClass)},_resetClass:function(t){t._ui.$errorClassHandler.removeClass(t.options.successClass).removeClass(t.options.errorClass)}};var v=function(n,r,s){this.__class__="ParsleyForm",this.__id__=i.generateID(),this.$element=e(n),this.domOptions=r,this.options=s,this.parent=window.Parsley,this.fields=[],this.validationResult=null},m={pending:null,resolved:!0,rejected:!1};v.prototype={onSubmitValidate:function(t){var n=this;if(!0===t.parsley)return;this._$submitSource=this._$submitSource||this.$element.find('input[type="submit"], button[type="submit"]').first();if(this._$submitSource.is("[formnovalidate]")){this._$submitSource=null;return}return t.stopImmediatePropagation(),t.preventDefault(),this.whenValidate(undefined,undefined,t).done(function(){n._submit()}).always(function(){n._$submitSource=null}),this},onSubmitButton:function(n){this._$submitSource=e(n.target)},_submit:function(){if(!1===this._trigger("submit"))return;this.$element.find(".parsley_synthetic_submit_button").remove(),this._$submitSource&&e('<input class="parsley_synthetic_submit_button" type="hidden">').attr("name",this._$submitSource.attr("name")).attr("value",this._$submitSource.attr("value")).appendTo(this.$element),this.$element.trigger(e.extend(e.Event("submit"),{parsley:!0}))},validate:function(t,n,r){return m[this.whenValidate(t,n,r).state()]},whenValidate:function(n,r,i){var s=this;this.submitEvent=i,this.validationResult=!0,this._trigger("validate"),this._refreshFields();var o=this._withoutReactualizingFormOptions(function(){return e.map(this.fields,function(e){if(!n||s._isFieldInGroup(e,n))return e.whenValidate(r)})}),u=function(){var n=e.Deferred();return!1===s.validationResult&&n.reject(),n.resolve().promise()};return e.when.apply(e,o).done(function(){s._trigger("success")}).fail(function(){s.validationResult=!1,s._trigger("error")}).always(function(){s._trigger("validated")}).pipe(u,u)},isValid:function(t,n){return m[this.whenValid(t,n).state()]},whenValid:function(n,r){var i=this;this._refreshFields();var s=this._withoutReactualizingFormOptions(function(){return e.map(this.fields,function(e){if(!n||i._isFieldInGroup(e,n))return e.whenValid(r)})});return e.when.apply(e,s)},_isFieldInGroup:function(n,r){return e.isArray(n.options.group)?-1!==e.inArray(r,n.options.group):n.options.group===r},_refreshFields:function(){return this.actualizeOptions()._bindFields()},_bindFields:function(){var n=this,r=this.fields;return this.fields=[],this.fieldsMappedById={},this._withoutReactualizingFormOptions(function(){this.$element.find(this.options.inputs).not(this.options.excluded).each(function(){var e=new window.Parsley.Factory(this,{},n);("ParsleyField"===e.__class__||"ParsleyFieldMultiple"===e.__class__)&&!0!==e.options.excluded&&"undefined"==typeof n.fieldsMappedById[e.__class__+"-"+e.__id__]&&(n.fieldsMappedById[e.__class__+"-"+e.__id__]=e,n.fields.push(e))}),e(r).not(n.fields).each(function(){this._trigger("reset")})}),this},_withoutReactualizingFormOptions:function(t){var n=this.actualizeOptions;this.actualizeOptions=function(){return this};var r=t.call(this);return this.actualizeOptions=n,r},_trigger:function(t){return this.trigger("form:"+t)}};var g=function(n,r,i,s,o){if(!(new RegExp("ParsleyField")).test(n.__class__))throw new Error("ParsleyField or ParsleyFieldMultiple instance expected");var u=window.Parsley._validatorRegistry.validators[r],a=new c(u);e.extend(this,{validator:a,name:r,requirements:i,priority:s||n.options[r+"Priority"]||a.priority,isDomConstraint:!0===o}),this._parseRequirements(n.options)},y=function(t){var n=t[0].toUpperCase();return n+t.slice(1)};g.prototype={validate:function(t,n){var r=this.requirementList.slice(0);return r.unshift(t),r.push(n),this.validator.validate.apply(this.validator,r)},_parseRequirements:function(t){var n=this;this.requirementList=this.validator.parseRequirements(this.requirements,function(e){return t[n.name+y(e)]})}};var b=function(n,r,s,o){this.__class__="ParsleyField",this.__id__=i.generateID(),this.$element=e(n),"undefined"!=typeof o&&(this.parent=o),this.options=s,this.domOptions=r,this.constraints=[],this.constraintsByName={},this.validationResult=[],this._bindConstraints()},w={pending:null,resolved:!0,rejected:!1};b.prototype={validate:function(t){var n=this.whenValidate(t);switch(n.state()){case"pending":return null;case"resolved":return!0;case"rejected":return this.validationResult}},whenValidate:function(t){var n=this;return this.value=this.getValue(),this._trigger("validate"),this.whenValid(t,this.value).done(function(){n._trigger("success")}).fail(function(){n._trigger("error")}).always(function(){n._trigger("validated")})},hasConstraints:function(){return 0!==this.constraints.length},needsValidation:function(t){return"undefined"==typeof t&&(t=this.getValue()),!t.length&&!this._isRequired()&&"undefined"==typeof this.options.validateIfEmpty?!1:!0},isValid:function(t,n){return w[this.whenValid(t,n).state()]},whenValid:function(n,r){this.refreshConstraints(),this.validationResult=!0;if(!this.hasConstraints())return e.when();"boolean"!=typeof n&&"undefined"==typeof r&&(r=n,n=!1);if("undefined"==typeof r||null===r)r=this.getValue();if(!this.needsValidation(r)&&!0!==n)return e.when();var i=this._getGroupedConstraints(),s=[],o=this;return e.each(i,function(t,n){var i=e.when.apply(e,e.map(n,e.proxy(o,"_validateConstraint",r)));s.push(i);if(i.state()==="rejected")return!1}),e.when.apply(e,s)},_validateConstraint:function(n,r){var i=this,s=r.validate(n,this);return!1===s&&(s=e.Deferred().reject()),e.when(s).fail(function(e){!0===i.validationResult&&(i.validationResult=[]),i.validationResult.push({assert:r,errorMessage:"string"==typeof e&&e})})},getValue:function(){var t;return"function"==typeof this.options.value?t=this.options.value(this):"undefined"!=typeof this.options.value?t=this.options.value:t=this.$element.val(),"undefined"==typeof t||null===t?"":this._handleWhitespace(t)},refreshConstraints:function(){return this.actualizeOptions()._bindConstraints()},addConstraint:function(t,n,r,i){if(window.Parsley._validatorRegistry.validators[t]){var s=new g(this,t,n,r,i);"undefined"!==this.constraintsByName[s.name]&&this.removeConstraint(s.name),this.constraints.push(s),this.constraintsByName[s.name]=s}return this},removeConstraint:function(t){for(var n=0;n<this.constraints.length;n++)if(t===this.constraints[n].name){this.constraints.splice(n,1);break}return delete this.constraintsByName[t],this},updateConstraint:function(t,n,r){return this.removeConstraint(t).addConstraint(t,n,r)},_bindConstraints:function(){var t=[],n={};for(var r=0;r<this.constraints.length;r++)!1===this.constraints[r].isDomConstraint&&(t.push(this.constraints[r]),n[this.constraints[r].name]=this.constraints[r]);this.constraints=t,this.constraintsByName=n;for(var i in this.options)this.addConstraint(i,this.options[i],undefined,!0);return this._bindHtml5Constraints()},_bindHtml5Constraints:function(){(this.$element.hasClass("required")||this.$element.attr("required"))&&this.addConstraint("required",!0,undefined,!0),"string"==typeof this.$element.attr("pattern")&&this.addConstraint("pattern",this.$element.attr("pattern"),undefined,!0),"undefined"!=typeof this.$element.attr("min")&&"undefined"!=typeof this.$element.attr("max")?this.addConstraint("range",[this.$element.attr("min"),this.$element.attr("max")],undefined,!0):"undefined"!=typeof this.$element.attr("min")?this.addConstraint("min",this.$element.attr("min"),undefined,!0):"undefined"!=typeof this.$element.attr("max")&&this.addConstraint("max",this.$element.attr("max"),undefined,!0),"undefined"!=typeof this.$element.attr("minlength")&&"undefined"!=typeof this.$element.attr("maxlength")?this.addConstraint("length",[this.$element.attr("minlength"),this.$element.attr("maxlength")],undefined,!0):"undefined"!=typeof this.$element.attr("minlength")?this.addConstraint("minlength",this.$element.attr("minlength"),undefined,!0):"undefined"!=typeof this.$element.attr("maxlength")&&this.addConstraint("maxlength",this.$element.attr("maxlength"),undefined,!0);var t=this.$element.attr("type");return"undefined"==typeof t?this:"number"===t?"undefined"==typeof this.$element.attr("step")||0===parseFloat(this.$element.attr("step"))%1?this.addConstraint("type","integer",undefined,!0):this.addConstraint("type","number",undefined,!0):/^(email|url|range)$/i.test(t)?this.addConstraint("type",t,undefined,!0):this},_isRequired:function(){return"undefined"==typeof this.constraintsByName.required?!1:!1!==this.constraintsByName.required.requirements},_trigger:function(t){return this.trigger("field:"+t)},_handleWhitespace:function(t){!0===this.options.trimValue&&i.warnOnce('data-parsley-trim-value="true" is deprecated, please use data-parsley-whitespace="trim"'),"squish"===this.options.whitespace&&(t=t.replace(/\s{2,}/g," "));if("trim"===this.options.whitespace||"squish"===this.options.whitespace||!0===this.options.trimValue)t=i.trimString(t);return t},_getGroupedConstraints:function(){if(!1===this.options.priorityEnabled)return[this.constraints];var t=[],n={};for(var r=0;r<this.constraints.length;r++){var i=this.constraints[r].priority;n[i]||t.push(n[i]=[]),n[i].push(this.constraints[r])}return t.sort(function(e,t){return t[0].priority-e[0].priority}),t}};var E=b,S=function(){this.__class__="ParsleyFieldMultiple"};S.prototype={addElement:function(t){return this.$elements.push(t),this},refreshConstraints:function(){var n;this.constraints=[];if(this.$element.is("select"))return this.actualizeOptions()._bindConstraints(),this;for(var r=0;r<this.$elements.length;r++){if(!e("html").has(this.$elements[r]).length){this.$elements.splice(r,1);continue}n=this.$elements[r].data("ParsleyFieldMultiple").refreshConstraints().constraints;for(var i=0;i<n.length;i++)this.addConstraint(n[i].name,n[i].requirements,n[i].priority,n[i].isDomConstraint)}return this},getValue:function(){if("undefined"!=typeof this.options.value)return this.options.value;if(this.$element.is("input[type=radio]"))return this._findRelatedMultiple().filter(":checked").val()||"";if(this.$element.is("input[type=checkbox]")){var n=[];return this._findRelatedMultiple().filter(":checked").each(function(){n.push(e(this).val())}),n}return this.$element.is("select")&&null===this.$element.val()?[]:this.$element.val()},_init:function(){return this.$elements=[this.$element],this}};var x=function(n,r,i){this.$element=e(n);var s=this.$element.data("Parsley");if(s)return"undefined"!=typeof i&&s.parent===window.Parsley&&(s.parent=i,s._resetOptions(s.options)),s;if(!this.$element.length)throw new Error("You must bind Parsley on an existing element.");if("undefined"!=typeof i&&"ParsleyForm"!==i.__class__)throw new Error("Parent instance must be a ParsleyForm instance");return this.parent=i||window.Parsley,this.init(r)};x.prototype={init:function(t){return this.__class__="Parsley",this.__version__="@@version",this.__id__=i.generateID(),this._resetOptions(t),this.$element.is("form")||i.checkAttr(this.$element,this.options.namespace,"validate")&&!this.$element.is(this.options.inputs)?this.bind("parsleyForm"):this.isMultiple()?this.handleMultiple():this.bind("parsleyField")},isMultiple:function(){return this.$element.is("input[type=radio], input[type=checkbox]")||this.$element.is("select")&&"undefined"!=typeof this.$element.attr("multiple")},handleMultiple:function(){var n=this,r,s,o;this.options.multiple||("undefined"!=typeof this.$element.attr("name")&&this.$element.attr("name").length?this.options.multiple=r=this.$element.attr("name"):"undefined"!=typeof this.$element.attr("id")&&this.$element.attr("id").length&&(this.options.multiple=this.$element.attr("id")));if(this.$element.is("select")&&"undefined"!=typeof this.$element.attr("multiple"))return this.options.multiple=this.options.multiple||this.__id__,this.bind("parsleyFieldMultiple");if(!this.options.multiple)return i.warn("To be bound by Parsley, a radio, a checkbox and a multiple select input must have either a name or a multiple option.",this.$element),this;this.options.multiple=this.options.multiple.replace(/(:|\.|\[|\]|\{|\}|\$)/g,""),"undefined"!=typeof r&&e('input[name="'+r+'"]').each(function(){e(this).is("input[type=radio], input[type=checkbox]")&&e(this).attr(n.options.namespace+"multiple",n.options.multiple)});var u=this._findRelatedMultiple();for(var a=0;a<u.length;a++){o=e(u.get(a)).data("Parsley");if("undefined"!=typeof o){this.$element.data("ParsleyFieldMultiple")||o.addElement(this.$element);break}}return this.bind("parsleyField",!0),o||this.bind("parsleyFieldMultiple")},bind:function(n,r){var s;switch(n){case"parsleyForm":s=e.extend(new v(this.$element,this.domOptions,this.options),window.ParsleyExtend)._bindFields();break;case"parsleyField":s=e.extend(new E(this.$element,this.domOptions,this.options,this.parent),window.ParsleyExtend);break;case"parsleyFieldMultiple":s=e.extend(new E(this.$element,this.domOptions,this.options,this.parent),new S,window.ParsleyExtend)._init();break;default:throw new Error(n+"is not a supported Parsley type")}return this.options.multiple&&i.setAttr(this.$element,this.options.namespace,"multiple",this.options.multiple),"undefined"!=typeof r?(this.$element.data("ParsleyFieldMultiple",s),s):(this.$element.data("Parsley",s),s._trigger("init"),s)}};var T=e.fn.jquery.split(".");if(parseInt(T[0])<=1&&parseInt(T[1])<8)throw"The loaded version of jQuery is too old. Please upgrade to 1.8.x or better.";T.forEach||i.warn("Parsley requires ES5 to run properly. Please include https://github.com/es-shims/es5-shim");var N=e.extend(new o,{$element:e(document),actualizeOptions:null,_resetOptions:null,Factory:x,version:"@@version"});e.extend(E.prototype,o.prototype),e.extend(v.prototype,o.prototype),e.extend(x.prototype,o.prototype),e.fn.parsley=e.fn.psly=function(t){if(this.length>1){var n=[];return this.each(function(){n.push(e(this).parsley(t))}),n}if(!e(this).length){i.warn("You must bind Parsley on an existing element.");return}return new x(this,t)},"undefined"==typeof window.ParsleyExtend&&(window.ParsleyExtend={}),N.options=e.extend(i.objectCreate(s),window.ParsleyConfig),window.ParsleyConfig=N.options,window.Parsley=window.psly=N,window.ParsleyUtils=i;var C=window.Parsley._validatorRegistry=new h(window.ParsleyConfig.validators,window.ParsleyConfig.i18n);window.ParsleyValidator={},e.each("setLocale addCatalog addMessage addMessages getErrorMessage formatMessage addValidator updateValidator removeValidator".split(" "),function(t,n){window.Parsley[n]=e.proxy(C,n),window.ParsleyValidator[n]=function(){return i.warnOnce("Accessing the method '"+n+"' through ParsleyValidator is deprecated. Simply call 'window.Parsley."+n+"(...)'"),window.Parsley[n].apply(window.Parsley,arguments)}}),window.ParsleyUI="function"==typeof window.ParsleyConfig.ParsleyUI?(new window.ParsleyConfig.ParsleyUI).listen():(new d).listen(),!1!==window.ParsleyConfig.autoBind&&e(function(){e("[data-parsley-validate]").length&&e("[data-parsley-validate]").parsley()});var k=e({}),L=function(){i.warnOnce("Parsley's pubsub module is deprecated; use the 'on' and 'off' methods on parsley instances or window.Parsley")},O="parsley:";e.listen=function(e,t){var n;L(),"object"==typeof arguments[1]&&"function"==typeof arguments[2]&&(n=arguments[1],t=arguments[2]);if("function"!=typeof t)throw new Error("Wrong parameters");window.Parsley.on(M(e),A(t,n))},e.listenTo=function(e,t,n){L();if(!(e instanceof E||e instanceof v))throw new Error("Must give Parsley instance");if("string"!=typeof t||"function"!=typeof n)throw new Error("Wrong parameters");e.on(M(t),A(n))},e.unsubscribe=function(e,t){L();if("string"!=typeof e||"function"!=typeof t)throw new Error("Wrong arguments");window.Parsley.off(M(e),t.parsleyAdaptedCallback)},e.unsubscribeTo=function(e,t){L();if(!(e instanceof E||e instanceof v))throw new Error("Must give Parsley instance");e.off(M(t))},e.unsubscribeAll=function(t){L(),window.Parsley.off(M(t)),e("form,input,textarea,select").each(function(){var n=e(this).data("Parsley");n&&n.off(M(t))})},e.emit=function(e,t){L();var n=t instanceof E||t instanceof v,r=Array.prototype.slice.call(arguments,n?2:1);r.unshift(M(e)),n||(t=window.Parsley),t.trigger.apply(t,r)};var _={};e.extend(!0,N,{asyncValidators:{"default":{fn:function(t){return t.status>=200&&t.status<300},url:!1},reverse:{fn:function(t){return t.status<200||t.status>=300},url:!1}},addAsyncValidator:function(t,n,r,i){return N.asyncValidators[t]={fn:n,url:r||!1,options:i||{}},this},eventValidate:function(t){if((new RegExp("key")).test(t.type)&&!this._ui.validationInformationVisible&&this.getValue().length<=this.options.validationThreshold)return;this._ui.validatedOnce=!0,this.whenValidate()}}),N.addValidator("remote",{requirementType:{"":"string",validator:"string",reverse:"boolean",options:"object"},validateString:function(n,r,i,s){var o={},u,a,f=i.validator||(!0===i.reverse?"reverse":"default");if("undefined"==typeof N.asyncValidators[f])throw new Error("Calling an undefined async validator: `"+f+"`");r=N.asyncValidators[f].url||r,r.indexOf("{value}")>-1?r=r.replace("{value}",encodeURIComponent(n)):o[s.$element.attr("name")||s.$element.attr("id")]=n;var l=e.extend(!0,i.options||{},N.asyncValidators[f].options);u=e.extend(!0,{},{url:r,data:o,type:"GET"},l),s.trigger("field:ajaxoptions",s,u),a=e.param(u),"undefined"==typeof N._remoteCache&&(N._remoteCache={});var c=N._remoteCache[a]=N._remoteCache[a]||e.ajax(u),h=function(){var n=N.asyncValidators[f].fn.call(s,c,r,i);return n||(n=e.Deferred().reject()),e.when(n)};return c.then(h,h)},priority:-1}),N.on("form:submit",function(){N._remoteCache={}}),window.ParsleyExtend.addAsyncValidator=function(){return ParsleyUtils.warnOnce("Accessing the method `addAsyncValidator` through an instance is deprecated. Simply call `Parsley.addAsyncValidator(...)`"),N.apply(N.addAsyncValidator,arguments)},N.addMessages("en",{defaultMessage:"This value seems to be invalid.",type:{email:"This value should be a valid email.",url:"This value should be a valid url.",number:"This value should be a valid number.",integer:"This value should be a valid integer.",digits:"This value should be digits.",alphanum:"This value should be alphanumeric."},notblank:"This value should not be blank.",required:"This value is required.",pattern:"This value seems to be invalid.",min:"This value should be greater than or equal to %s.",max:"This value should be lower than or equal to %s.",range:"This value should be between %s and %s.",minlength:"This value is too short. It should have %s characters or more.",maxlength:"This value is too long. It should have %s characters or fewer.",length:"This value length is invalid. It should be between %s and %s characters long.",mincheck:"You must select at least %s choices.",maxcheck:"You must select %s choices or fewer.",check:"You must select between %s and %s choices.",equalto:"This value should be the same."}),N.setLocale("en"),N.addMessages("zh-cn",{defaultMessage:"不正确的值",type:{email:"请输入一个有效的电子邮箱地址",url:"请输入一个有效的链接",number:"请输入正确的数字",integer:"请输入正确的整数",digits:"请输入正确的号码",alphanum:"请输入字母或数字"},notblank:"请输入值",required:"必填项",pattern:"格式不正确",min:"输入值请大于或等于 %s",max:"输入值请小于或等于 %s",range:"输入值应该在 %s 到 %s 之间",minlength:"请输入至少 %s 个字符",maxlength:"请输入至多 %s 个字符",length:"字符长度应该在 %s 到 %s 之间",mincheck:"请至少选择 %s 个选项",maxcheck:"请选择不超过 %s 个选项",check:"请选择 %s 到 %s 个选项",equalto:"输入值不同"}),N.setLocale("zh-cn"),N.addMessages("zh-cn",{dateiso:"请输入正确格式的日期 (YYYY-MM-DD)."});var D=N;return D});